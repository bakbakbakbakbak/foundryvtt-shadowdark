{
  "name": "Draw Trap",
  "type": "script",
  "author": "EKVggA45fx6fzkCK",
  "img": "icons/environment/traps/trap-jaw-green.webp",
  "scope": "global",
  "command": "const pack = game.packs.get(\"shadowdark.rollable-tables\");\n\nconst trapTableID = pack.index.find(o => o.name === \"Trap: Trap\")._id;\nconst trapTable = await pack.getDocument(trapTableID);\nconst trapResult = await trapTable.draw({displayChat: false});\nconst trap = trapResult.results.pop().getChatText();\n\nconst triggerTableID = pack.index.find(o => o.name === \"Trap: Trigger\")._id;\nconst triggerTable = await pack.getDocument(triggerTableID);\nconst triggerResult = await triggerTable.draw({displayChat: false});\nconst trigger = triggerResult.results.pop().getChatText();\n\nconst effectTableID = pack.index.find(o => o.name === \"Trap: Damage or Effect\")._id;\nconst effectTable = await pack.getDocument(effectTableID);\nconst effectResult = await effectTable.draw({displayChat: false});\nconst effect = effectResult.results.pop().getChatText();\n\nconst message = `<p>A <b>${trap}</b> trap that is triggered by <b>${trigger}</b> \n  that causes <b>${effect}</b></p>`;\n\nconst chatData = {\n  user: game.user._id,\n  speaker: ChatMessage.getSpeaker(),\n  content: message,\n  whisper: game.users.filter(u => u.isGM).map(u => u._id),\n};\n\nChatMessage.create(chatData, {});",
  "ownership": {
    "default": 0,
    "EKVggA45fx6fzkCK": 3
  },
  "flags": {
    "core": {
      "sourceId": "Macro.cjt1zht61fuzGH0i"
    }
  },
  "_stats": {
    "systemId": "shadowdark",
    "systemVersion": "0.1.0",
    "coreVersion": "10.291",
    "createdTime": 1679217237815,
    "modifiedTime": 1679218836910,
    "lastModifiedBy": "EKVggA45fx6fzkCK"
  },
  "folder": null,
  "sort": 0,
  "_id": "B4UwIKe2sBuhSHfs"
}